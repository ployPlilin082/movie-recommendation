<div class="events-wrap">

  <h3 class="page-title">ЁЯУЕ р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Кр╕╕р╕бр╕Кр╕Щ</h3>
  <p class="subtitle">р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕ар╕▓р╕Юр╕вр╕Щр╕Хр╕гр╣М</p>

  <!-- CREATE EVENT -->
  <div class="create-box">

    <!-- SEARCH MOVIE -->
    <input class="search-input" placeholder="ЁЯФН р╕Др╣Йр╕Щр╕лр╕▓р╕лр╕Щр╕▒р╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Щр╕Ър╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б" [(ngModel)]="movieKeyword"
      (ngModelChange)="searchMovie()" />

    <!-- SEARCH RESULT -->
    <div class="movie-result" *ngIf="movieResults.length">
      <div class="movie-item" *ngFor="let m of movieResults" (click)="selectMovie(m)">
        <img [src]="getPoster(m.posterPath)" />
        <span class="movie-title">{{ m.title }}</span>
      </div>
    </div>

    <div class="selected-movie" *ngIf="selectedMovie">
      <span>ЁЯОм р╣Бр╕Щр╕Ър╣Бр╕ер╣Йр╕з: <b>{{ selectedMovie.title }}</b></span>
      <button type="button" class="mini-btn" (click)="clearMovie()">тЬХ</button>
    </div>

    <input [(ngModel)]="title" placeholder="р╕Кр╕╖р╣Ир╕нр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б" />
    <textarea [(ngModel)]="description" placeholder="р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф"></textarea>

    <div class="date-row">
      <div class="date-field">
        <label>ЁЯУЕ р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕┤р╣Ир╕б</label>
        <input type="date" [(ngModel)]="startDate" />
      </div>

      <div class="date-field">
        <label>ЁЯУЕ р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕кр╕┤р╣Йр╕Щр╕кр╕╕р╕Ф</label>
        <input type="date" [(ngModel)]="endDate" />
      </div>
    </div>

  <button class="primary-btn" (click)="editingEvent ? update() : create()">
  {{ editingEvent ? 'ЁЯТ╛ р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В' : 'тЮХ р╕кр╕гр╣Йр╕▓р╕Зр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б' }}
</button>

  </div>

  <!-- LIST -->
  <div class="event-card" *ngFor="let e of events" [style.backgroundImage]="(e.Movie?.BackdropPath || e.movie?.backdropPath)
      ? 'url(https://image.tmdb.org/t/p/w780' + (e.Movie?.BackdropPath || e.movie?.backdropPath) + ')'
      : ''">
    <div class="event-overlay">
      <!-- р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Ар╕Др╕кр╕Хр╕▒р╕зр╣Гр╕лр╕Нр╣И/р╕Хр╕▒р╕зр╣Ар╕ер╣Зр╕Б -->
      <ng-container *ngIf="(e.Movie || e.movie) as mv"></ng-container>

      <div class="event-header">
        ЁЯОп {{ e.Title || e.title }}
      </div>

      <p class="event-desc">{{ e.Description || e.description }}</p>

      <div class="event-date">
        ЁЯУЕ {{ (e.StartDate || e.startDate) | date:'mediumDate' }}
        <span *ngIf="e.EndDate || e.endDate">
          тАУ {{ (e.EndDate || e.endDate) | date:'mediumDate' }}
        </span>
      </div>

      <div class="event-movie" *ngIf="e.Movie || e.movie">
        ЁЯОм {{ (e.Movie?.Title || e.movie?.title) }}
      </div>

      <!-- OWNER ACTION -->
      <div class="event-actions" *ngIf="(e.IsOwner ?? e.isOwner) === true">
        <button class="edit" type="button" (click)="onEdit(e)">
          тЬПя╕П р╣Бр╕Бр╣Йр╣Др╕В
        </button>

        <button class="delete" type="button" (click)="delete(e.Id ?? e.id)">ЁЯЧС р╕ер╕Ъ</button>
      </div>
    </div>
  </div>

  <div class="state" *ngIf="events.length === 0">
    р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б
  </div>

</div>